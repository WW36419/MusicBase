<div>
    <form [formGroup]="albumAddForm" (ngSubmit)="addAlbum()">
        <fieldset>
            <legend>Dodaj nowy album:</legend>
            <div class="input-group"><label for="name"></label>
                <input type="text" class="form-control" id="name" formControlName="name" placeholder="Nazwa...">
            </div>

            @if (artists.length > 0) {
                <div>
                    <h4>Artyści:</h4>
                    @for (item of artists; track item) {
                        <div class="card">
                            <p>{{item.name}}</p>
                        </div>
                    }
                </div>
            }
            <div>
                <form [formGroup]="artistPick" (ngSubmit)="addArtistToAlbum()">
                    <fieldset>
                        <legend>Dodaj artystę do piosenki:</legend>
                        <div>
                            <input
                                [(ngModel)]="artistQuery"
                                [ngModelOptions]="{standalone: true}"
                                (ngModelChange)="updateSearchedArtists()"
                                id="searchArtists"
                                type="search"
                                class="form-control"
                            >
                        </div>
                        <div class="input-group"><label for="artists"></label>
                            <select class="form-control" id="artists" formControlName="artist" size="4">
                                @for (item of searched_artists; track item) {
                                    <option [ngValue]="item">{{item.name}}</option>
                                }
                            </select>
                        </div>
                        <div>
                            <button class="btn btn-primary" type="submit" [disabled]="!artistPick.valid">Dodaj artystę do albumu</button>
                        </div>
                    </fieldset>
                </form>
            </div>

            @if (tracks.length > 0) {
                <div>
                    <h4>Piosenki w albumie:</h4>
                    @for (item of tracks; track item) {
                        <div class="card">
                            <p>{{item.name}}</p>
                        </div>
                    }
                </div>
            }
            <div>
                <form [formGroup]="trackPick" (ngSubmit)="addTrackToAlbum()">
                    <fieldset>
                        <legend>Dodaj wybrane piosenki do albumu:</legend>
                        <div class="input-group"><label for="tracks"></label>
                            <select class="form-control" id="tracks" formControlName="track" size="4">
                                @for (item of proposed_tracks; track item) {
                                    <option [ngValue]="item">{{item.name}} - {{item.artists[0].name}}</option>
                                }
                            </select>
                        </div>
                        <div>
                            <button class="btn btn-primary" type="submit" [disabled]="!trackPick.valid">Dodaj piosenkę do albumu</button>
                        </div>
                    </fieldset>
                </form>
            </div>

            <div class="input-group"><label for="album_type">Typ albumu: </label>
                <select class="form-control" id="album_type" formControlName="type">
                    <option value="album">Album</option>
                    <option value="single">Singiel</option>
                    <option value="compilation">Kompilacja</option>
                </select>
            </div>
            <div class="input-group"><label for="release_date">Data wydania piosenki: </label>
                <input type="date" class="form-control" id="release_date" formControlName="release_date">
            </div>
            <div class="input-group"><label for="popularity">Popularność (od 0 do 100): </label>
                <input type="number" class="form-control" id="popularity" formControlName="popularity" min="0" max="100">
            </div>
            <div class="input-group"><label for="image_url">Link do obrazu albumu (długość max. 200): </label>
                <input type="url" class="form-control" id="image_url" formControlName="image_url" maxlength="200">
            </div>

            <div>
                <button class="btn btn-primary" type="submit" [disabled]="!albumAddForm.valid">Dodaj</button>
            </div>
        </fieldset>
    </form>
</div>